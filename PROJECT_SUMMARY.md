
# ملخص تقدم مشروع RestoSwift POS

## نظرة عامة
يهدف مشروع RestoSwift POS إلى تطوير نظام نقاط بيع (POS) حديث وسهل الاستخدام للمطاعم، مع التركيز على اللغة العربية والعملة السورية (ل.س). تم بناء المشروع باستخدام Next.js (App Router)، React، TypeScript، و Tailwind CSS، مع الاستعانة بمكونات ShadCN UI.

## المراحل والوظائف المنجزة:

1.  **الإعداد الأولي للمشروع:**
    *   إنشاء مشروع Next.js جديد باستخدام أحدث إصدار (يدعم App Router).
    *   تثبيت وإعداد Tailwind CSS لتصميم الواجهات.
    *   تضمين TypeScript لضمان جودة الكود وسلامة الأنواع.
    *   إعداد ESLint لتوحيد نمط الكود.

2.  **إدارة البيانات الأساسية (قاعدة بيانات محلية):**
    *   اعتماد `Lowdb` كحل قاعدة بيانات محلية بسيطة، باستخدام ملف `db.json` في جذر المشروع لتخزين:
        *   `menuItems`: قائمة أصناف الطعام (الاسم، السعر، الفئة، حالة التوفر، معرف فريد).
        *   `orders`: قائمة الطلبات المكتملة (معرف فريد تسلسلي رقمي، الطابع الزمني، الأصناف المطلوبة وكمياتها، المبلغ الإجمالي، الحالة، طريقة الدفع).
        *   `lastOrderId`: لتتبع آخر رقم فاتورة تم استخدامه.
        *   `expenses`: قائمة المصروفات (معرف، وصف، مبلغ، تاريخ، فئة).
        *   `appSettings`: إعدادات التطبيق مثل `restaurantName`.
    *   إنشاء `src/lib/db.ts` لتهيئة Lowdb وتحديد هياكل البيانات (interfaces).
    *   توفير بيانات أولية (افتراضية) في `db.json` لبدء تشغيل التطبيق.

3.  **وظائف الخادم (Server Actions):**
    *   إنشاء `src/app/actions.ts` لتضمين منطق التعامل مع قاعدة البيانات من جانب الخادم بشكل آمن:
        *   `getMenuItems(onlyAvailable: boolean)`: لجلب قائمة أصناف الطعام.
        *   `addMenuItemAction(...)`: لإضافة صنف جديد.
        *   `updateMenuItemAction(...)`: لتحديث صنف موجود.
        *   `toggleMenuItemAvailabilityAction(id: string)`: لتبديل حالة توفر صنف.
        *   `deleteMenuItemAction(id: string)`: لحذف صنف (مع تأكيد).
        *   `completeOrderAndPrint(orderItems: OrderItem[])`: لإتمام الطلب وحفظه.
        *   `getDailySalesReport()`: لجلب تقرير المبيعات اليومي.
        *   `getItemSalesCountReport(startDate?: number, endDate?: number)`: لجلب تقرير كميات الأصناف المباعة ضمن نطاق تاريخي.
        *   `addExpenseAction(...)`: لإضافة مصروف جديد.
        *   `getExpensesAction(startDate?: number, endDate?: number)`: لجلب المصروفات ضمن نطاق تاريخي.
        *   `deleteExpenseAction(id: string)`: لحذف مصروف.
        *   `getRestaurantNameAction()`: لجلب اسم المطعم الحالي.
        *   `updateRestaurantNameAction(newName: string)`: لتحديث اسم المطعم.

4.  **الواجهة الرئيسية لنقاط البيع (POS - `src/app/page.tsx`):**
    *   تصميم مقسم لعرض أصناف الطعام والفاتورة الحالية.
    *   إضافة الأصناف إلى الفاتورة بنقرة واحدة على بطاقتها.
    *   منع تحديد النص عند النقر المتكرر على بطاقات الأصناف.
    *   إتمام الطلب والطباعة مباشرة.
    *   تحسين تصميم الفاتورة المطبوعة لتكون أكثر احترافية.
    *   جعل أرقام الفواتير تسلسلية رقمية.

5.  **واجهة إدارة القائمة (`src/app/admin/menu/page.tsx`):**
    *   استخدام `MenuContext` لجلب وعرض قائمة الطعام من `db.json` والتفاعل مع Server Actions.
    *   نموذج لإضافة وتعديل أصناف الطعام.
    *   إمكانية تبديل حالة توفر الصنف.
    *   إمكانية حذف صنف مع مربع حوار تأكيدي.
    *   عرض مؤشرات التحميل ورسائل التنبيه (toasts).

6.  **واجهة التقارير (`src/app/admin/reports/page.tsx`):**
    *   التقرير اليومي (إجمالي المبيعات وعدد الفواتير) يتم جلبه "عند الطلب" بعد الضغط على زر.
    *   تقرير كميات الأصناف المباعة يمكن تصفيته حسب نطاق تاريخي محدد باستخدام `DatePicker`.
    *   عرض حالات التحميل والأخطاء.

7.  **واجهة إدارة المصاريف (`src/app/admin/expenses/page.tsx`):**
    *   نموذج لإضافة مصروف جديد (وصف، مبلغ، فئة - اختيارية).
    *   جدول لعرض المصروفات المسجلة مع إمكانية الحذف.
    *   إمكانية تصفية المصروفات حسب نطاق تاريخي باستخدام `DatePicker`.

8.  **واجهة الإعدادات (`src/app/admin/settings/page.tsx`):**
    *   نموذج لتغيير اسم المطعم المعروض في النظام.

9.  **التصميم والمظهر:**
    *   استخدام مكونات ShadCN UI بشكل واسع.
    *   تخصيص ألوان الواجهة عبر `src/app/globals.css`.
    *   دعم كامل للغة العربية والتخطيط من اليمين إلى اليسار (RTL).
    *   خيار تبديل السمة (فاتح/داكن/النظام).

## الوضع الحالي:
النظام يحتوي على وظائف نقاط بيع متكاملة، إدارة قائمة طعام، تقارير مبيعات، إدارة مصاريف، وإمكانية تغيير اسم المطعم. تم إلغاء ميزات تسجيل الدخول والمصادقة مؤقتًا للعودة إلى حالة مستقرة.

## الخطوات المستقبلية المحتملة (بعد استعادة الاستقرار):
*   إعادة بناء نظام تسجيل الدخول والصلاحيات بشكل تدريجي وحذر.
*   تحسين نظام التقارير (مثل تقارير مخصصة للموظفين بعد ربط الطلبات بهم).
*   إدارة المستخدمين والصلاحيات (لتمكين موظفي الكاشير من تسجيل الدخول وتنفيذ عمليات البيع فقط).
*   إضافة ميزة "فاتورة مرتجعة".
*   إضافة ميزات إدارة المخزون (بشكل مبسط).
*   الانتقال إلى قاعدة بيانات أكثر قوة في مرحلة الإنتاج.
*   إمكانية إضافة صور للأصناف في واجهة الإدارة وعرضها اختياريًا.
*   تحسين أمان كلمات المرور (استخدام تجزئة حقيقية مثل bcrypt).
```