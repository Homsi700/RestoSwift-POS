
# ملخص تقدم مشروع RestoSwift POS

## نظرة عامة
يهدف مشروع RestoSwift POS إلى تطوير نظام نقاط بيع (POS) حديث وسهل الاستخدام للمطاعم، مع التركيز على اللغة العربية والعملة السورية (ل.س). تم بناء المشروع باستخدام Next.js (App Router)، React، TypeScript، و Tailwind CSS، مع الاستعانة بمكونات ShadCN UI.

## المراحل والوظائف المنجزة:

1.  **الإعداد الأولي للمشروع:**
    *   إنشاء مشروع Next.js جديد باستخدام أحدث إصدار (يدعم App Router).
    *   تثبيت وإعداد Tailwind CSS لتصميم الواجهات.
    *   تضمين TypeScript لضمان جودة الكود وسلامة الأنواع.
    *   إعداد ESLint لتوحيد نمط الكود.

2.  **إدارة البيانات الأساسية (قاعدة بيانات محلية):**
    *   اعتماد `Lowdb` كحل قاعدة بيانات محلية بسيطة، باستخدام ملف `db.json` في جذر المشروع لتخزين:
        *   `menuItems`: قائمة أصناف الطعام (الاسم، السعر، الفئة، حالة التوفر، معرف فريد).
        *   `orders`: قائمة الطلبات المكتملة (معرف فريد، الطابع الزمني، الأصناف المطلوبة وكمياتها، المبلغ الإجمالي، الحالة، طريقة الدفع).
    *   إنشاء `src/lib/db.ts` لتهيئة Lowdb وتحديد هياكل البيانات (interfaces).
    *   توفير بيانات أولية (افتراضية) في `db.json` لبدء تشغيل التطبيق.

3.  **وظائف الخادم (Server Actions):**
    *   إنشاء `src/app/actions.ts` لتضمين منطق التعامل مع قاعدة البيانات من جانب الخادم بشكل آمن:
        *   `getMenuItems(onlyAvailable: boolean)`: لجلب قائمة أصناف الطعام (المتاحة فقط أو كلها).
        *   `addMenuItemAction(...)`: لإضافة صنف جديد إلى القائمة (للاستخدام في واجهة الإدارة).
        *   `updateMenuItemAction(...)`: لتحديث بيانات صنف موجود.
        *   `toggleMenuItemAvailabilityAction(id: string)`: لتبديل حالة توفر صنف معين.
        *   `completeOrderAndPrint(orderItems: OrderItem[])`: لإتمام الطلب، حفظه في `db.json`، وإرجاع بيانات الطلب المكتمل للطباعة.
    *   استخدام `nanoid` لتوليد معرفات فريدة للطلبات والأصناف.

4.  **الواجهة الرئيسية لنقاط البيع (POS - `src/app/page.tsx`):**
    *   تصميم مقسم إلى قسمين: قسم لعرض أصناف الطعام، وقسم لعرض الفاتورة الحالية.
    *   **عرض أصناف الطعام:**
        *   جلب قائمة الأصناف المتاحة من `db.json` عند تحميل الصفحة باستخدام Server Action `getMenuItems`.
        *   عرض كل صنف كبطاقة (`MenuItemCardComponent`) تُظهر الاسم والسعر.
        *   تمييز الأصناف غير المتوفرة بصريًا ومنع إضافتها للطلب.
    *   **إدارة الفاتورة الحالية (Client-Side State):**
        *   إضافة الأصناف إلى الفاتورة عند النقر على بطاقتها.
        *   زيادة كمية الصنف إذا كان موجودًا بالفعل في الفاتورة.
        *   عرض قائمة تفصيلية بالأصناف المضافة في الفاتورة (الاسم، الكمية، السعر، الإجمالي الفرعي للصنف).
        *   توفير أزرار لتعديل كمية كل صنف (زيادة/نقصان) أو حذفه من الفاتورة.
        *   حساب وعرض المبلغ الإجمالي للفاتورة بشكل ديناميكي.
    *   **إتمام الطلب والطباعة:**
        *   زر "إغلاق الفاتورة ودفع" يتم تفعيله فقط إذا كانت الفاتورة تحتوي على أصناف.
        *   عند النقر، يتم استدعاء Server Action `completeOrderAndPrint` لتسجيل الطلب.
        *   بعد نجاح الحفظ، يتم مسح الفاتورة الحالية من الواجهة.
        *   تشغيل `window.print()` لعرض نافذة طباعة المتصفح، مع تصميم مبدئي للفاتورة يتضمن التفاصيل الأساسية (اسم المطعم، رقم الفاتورة، التاريخ، الأصناف، الكميات، الأسعار، الإجمالي).
        *   استخدام أيقونات `@heroicons/react` لتحسين الواجهة.

5.  **واجهة إدارة القائمة (`src/app/admin/menu/page.tsx`):**
    *   استخدام `MenuContext` لإدارة حالة قائمة الطعام في هذه الواجهة (يتم الآن تحديث البيانات الفعلية في `db.json` عبر Server Actions).
    *   نموذج لإضافة صنف جديد إلى القائمة مع التحقق من صحة المدخلات (`AddItemForm`).
    *   إمكانية تعديل بيانات صنف موجود (الاسم، السعر، الفئة) عبر نموذج (`EditItemForm` يظهر في `Dialog`).
    *   عرض جميع أصناف القائمة (المتاحة وغير المتاحة) كبطاقات (`MenuItemCard`).
    *   أزرار تحكم إدارية على كل بطاقة صنف لـ:
        *   تبديل حالة التوفر (متاح/غير متاح).
        *   فتح نموذج التعديل.

6.  **التصميم والمظهر:**
    *   استخدام مكونات ShadCN UI (مثل `Card`, `Button`, `Input`, `Dialog`, `ScrollArea`, `Separator`, `Toaster`) لبناء واجهة مستخدم متناسقة واحترافية.
    *   تخصيص ألوان الواجهة (السمة) عبر ملف `src/app/globals.css` باستخدام متغيرات HSL CSS.
    *   تطبيق خطوط مخصصة (Cairo و Playfair Display) للمحتوى العربي.
    *   دعم كامل للغة العربية والتخطيط من اليمين إلى اليسار (RTL).
    *   إضافة خيار تبديل السمة (فاتح/داكن/النظام) باستخدام `ThemeProvider` و `ThemeToggle`.

7.  **تحسينات وتعديلات محددة:**
    *   تصغير حجم بطاقات عرض أصناف الطعام في واجهة نقاط البيع لعرض عدد أكبر من العناصر، مع التركيز على الاسم والسعر فقط.
    *   إصلاح خطأ استيراد `JSONFileSync` من مكتبة `lowdb`.
    *   نقاش وتطبيق مبدئي لآلية طباعة إيصالات تتناسب مع طابعات الكاشير الصغيرة.

## الوضع الحالي:
المشروع الآن يحتوي على نظام نقاط بيع وظيفي بواجهة رئيسية تسمح بتسجيل الطلبات وإتمامها وحفظها، بالإضافة إلى واجهة لإدارة قائمة الطعام. يستخدم التطبيق Lowdb كقاعدة بيانات محلية ويتم التفاعل معها عبر Server Actions. الواجهة باللغة العربية بالكامل وتدعم السمة الداكنة والفاتحة.

## الخطوات المستقبلية المحتملة:
*   تحسين تصميم الفاتورة المطبوعة.
*   إضافة المزيد من التقارير (مثل المبيعات اليومية).
*   إضافة ميزات إدارة المخزون (بشكل مبسط).
*   تحسينات على واجهة المستخدم وتجربة المستخدم.
*   الانتقال إلى قاعدة بيانات أكثر قوة في مرحلة الإنتاج (مثل Firebase Firestore أو PostgreSQL).
